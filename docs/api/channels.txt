API: Dimagi Chatbots v1
Description: Experiments with AI, GPT and LLMs

TAG: Channels

ENDPOINTS:

POST /api/trigger_bot
  Summary: Trigger the bot to send a message to the user
  Request Body:
    Content: application/json
    Schema: TriggerBotMessageRequest
  Responses:
    200: No response body
    400: 
      Content: application/json
      Schema: Unknown
    404: 
      Content: application/json
      Schema: Unknown
  Security:
    OAuth2
      - Required scopes: chatbots:interact
    apiKeyAuth
    tokenAuth

POST /channels/api/{experiment_id}/incoming_message
  Summary: New API Message
  Parameters:
    - experiment_id (path, string (required)): Experiment ID
  Request Body:
    Content: application/json
    Schema: ApiMessage
  Responses:
    200: 
      Content: application/json
      Schema: ApiResponseMessage
  Security:
    OAuth2
      - Required scopes: chatbots:interact
    apiKeyAuth
    tokenAuth

POST /channels/api/{experiment_id}/v{version}/incoming_message
  Summary: New API Message Versioned
  Parameters:
    - experiment_id (path, string (required)): Experiment ID
    - version (path, integer (required)): No description
    - version (query, string (optional)): Version of experiment
  Request Body:
    Content: application/json
    Schema: ApiMessage
  Responses:
    200: 
      Content: application/json
      Schema: ApiResponseMessage
  Security:
    OAuth2
      - Required scopes: chatbots:interact
    apiKeyAuth
    tokenAuth

SCHEMAS:

TriggerBotMessageRequest:
  - identifier: string (required) - The participant identifier
  - platform: Unknown (required) - The platform/channel type
  - experiment: string (required) - The experiment/chatbot ID
  - prompt_text: string (required) - The message prompt text to send to the bot
  - start_new_session: boolean (optional) - Whether to end the current session and start a new one
  - session_data: object (optional) - Arbitrary session state data. This data will be merged into the session state
  - page_context: object (optional) - Contextual information (e.g., current page URL, product IDs).
                                      This data is merged into the session state under the reserved 'page_context' key.
                                      Note: The 'page_context' key cannot be set directly in session_data; use this field instead.
  - participant_data: object (optional) - Arbitrary participant data to set or update

ApiMessage:
  - message: string (required)
  - session: string

ApiResponseMessage:
  - response: string (required)
  - attachments: array of ApiResponseAttachment (required)

SECURITY:
- OAuth2
  - Authorization Code Flow (authorization url: /o/authorize/, token url: /o/token/)
- API Key authentication (header: X-api-key)
- API Key authentication (cookie: sessionid)
- API Key authentication (header: X-Embed-Key)
- HTTP bearer authentication
